<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ุงุฎุชุจุงุฑ ุงููุญุงุฏุซุฉ ุจุงููุบุฉ ุงูุนุฑุจูุฉ</title>
    <script defer>
        let mediaRecorder;
        let audioChunks = [];
        let recordings = JSON.parse(localStorage.getItem("recordings")) || [];

        function startRecording() {
            audioChunks = [];
            navigator.mediaDevices.getUserMedia({ audio: true })
                .then(stream => {
                    mediaRecorder = new MediaRecorder(stream);
                    mediaRecorder.start();
                    mediaRecorder.ondataavailable = event => {
                        audioChunks.push(event.data);
                    };
                    mediaRecorder.onstop = () => {
                        const audioBlob = new Blob(audioChunks, { type: 'audio/wav' });
                        const audioUrl = URL.createObjectURL(audioBlob);
                        const fileName = "answer_" + new Date().toISOString().replace(/[:.]/g, "-") + ".wav";
                        recordings.push({ name: fileName, url: audioUrl });
                        localStorage.setItem("recordings", JSON.stringify(recordings));
                        displayRecordings();
                    };
                });
        }

        function stopRecording() {
            mediaRecorder.stop();
        }

        function displayRecordings() {
            const list = document.getElementById("recordingsList");
            list.innerHTML = "";
            recordings.forEach((rec, index) => {
                const listItem = document.createElement("li");
                const audio = document.createElement("audio");
                audio.controls = true;
                audio.src = rec.url;

                const downloadLink = document.createElement("a");
                downloadLink.href = rec.url;
                downloadLink.download = rec.name;
                downloadLink.textContent = "ุชุญููู";
                downloadLink.style.marginLeft = "10px";

                listItem.appendChild(audio);
                listItem.appendChild(downloadLink);
                list.appendChild(listItem);
            });
        }

        function clearRecordings() {
            if (confirm("ูู ุฃูุช ูุชุฃูุฏ ูู ุญุฐู ุฌููุน ุงูุชุณุฌููุงุชุ")) {
                localStorage.removeItem("recordings");
                recordings = [];
                displayRecordings();
            }
        }
    </script>
</head>
<body onload="displayRecordings()">
    <h2>ุงุฎุชุจุงุฑ ุงููุญุงุฏุซุฉ ุจุงููุบุฉ ุงูุนุฑุจูุฉ</h2>
    <p>ุงุณุชูุน ุฅูู ุงูุณุคุงู ุซู ูู ุจุชุณุฌูู ุฅุฌุงุจุชู.</p>
    <h3>ุงูุณุคุงู 1:</h3>
    <audio controls>
        <source src="question1.mp3.ogg" type="audio/ogg">
        ูุชุตูุญู ูุง ูุฏุนู ุชุดุบูู ุงูุตูุช.
    </audio>
    <br>
    <button onclick="startRecording()">ุงุจุฏุฃ ุงูุชุณุฌูู</button>
    <button onclick="stopRecording()">ุฃููู ุงูุชุณุฌูู</button>
    <br>
    <h3>ุงูุชุณุฌููุงุช ุงููุญููุธุฉ:</h3>
    <ul id="recordingsList"></ul>
    <br>
    <button onclick="clearRecordings()">๐๏ธ ุญุฐู ุฌููุน ุงูุชุณุฌููุงุช</button>
</body>
</html>
